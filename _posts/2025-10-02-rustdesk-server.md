---
layout: post
title: åœ¨äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½² RustDesk è‡ªå»ºæœåŠ¡å™¨
date: 2025-10-02 10:00:00
description: RustDesk ä½œä¸ºä¸€æ¬¾å¼€æºã€å®‰å…¨ã€è·¨å¹³å°çš„è¿œç¨‹æ¡Œé¢è½¯ä»¶ï¼Œå› å…¶è½»é‡ã€é«˜æ•ˆã€æ— å¹¿å‘Šä¸”æ”¯æŒè‡ªå»ºæœåŠ¡å™¨ç­‰ç‰¹æ€§ï¼Œå—åˆ°è¶Šæ¥è¶Šå¤šç”¨æˆ·çš„é’çã€‚è‡ªå»º RustDesk æœåŠ¡å™¨ä¸ä»…å¯ä»¥æ‘†è„±å¯¹å®˜æ–¹æœåŠ¡å™¨çš„ä¾èµ–ï¼Œè¿˜èƒ½å®Œå…¨æŒæ§è¿æ¥æ•°æ®ã€æå‡è¿æ¥é€Ÿåº¦ä¸ç¨³å®šæ€§ï¼Œå°¤å…¶é€‚åˆå¯¹éšç§å’Œæ€§èƒ½æœ‰è¾ƒé«˜è¦æ±‚çš„ä¸ªäººæˆ–å›¢é˜Ÿä½¿ç”¨ã€‚
tags: RustDesk "Remote Desktop" "Cloud Server"
categories: engineering
---

## RustDesk æœåŠ¡å™¨ä»‹ç»

RustDesk æœåŠ¡å™¨æœ‰ä¸¤ä¸ªå¯æ‰§è¡Œç¨‹åºï¼š
- `hbbs` - RustDesk ID æ³¨å†ŒæœåŠ¡å™¨ï¼Œæ˜¯ç®¡å„ä¸ªå®¢æˆ·ç«¯ ID çš„ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ ID ã€‚
- `hbbr` - RustDesk ä¸­ç»§æœåŠ¡å™¨ï¼Œæ˜¯è´Ÿè´£æ£€æµ‹ã€ä¸­è½¬å„ä¸ªå®¢æˆ·ç«¯è¿æ¥å’Œæ•°æ®ä¼ è¾“ã€‚

åœ¨éƒ¨ç½²å‰ï¼Œè¯·åŠ¡å¿…åœ¨ä¿è¯äº‘æœåŠ¡å™¨å¼€æ”¾äº†ä»¥ä¸‹ç«¯å£ï¼š
- TCP: 21115-21119
- UDP: 21116

RustDesk Server çš„è¿›ç¨‹å ç”¨ç«¯å£æƒ…å†µå¦‚ä¸‹ï¼š
- `hbbs` - 21115(TCP), 21116(TCP/UDP), 21118(TCP)
- `hbbr` - 21117(TCP), 21119(TCP)

æ¯ä¸ªç«¯å£éƒ½æœ‰å…¶å„è‡ªçš„ä½œç”¨ï¼š
- 21115(TCP) - ç”¨ä½œ NAT ç±»å‹æµ‹è¯•
- 21116(UDP) - ç”¨ä½œ ID æ³¨å†Œ ä¸ å¿ƒè·³æœåŠ¡
- 21116(TCP) - ç”¨ä½œ TCPæ‰“æ´ ä¸ è¿æ¥æœåŠ¡
- 21117(TCP) - ç”¨ä½œä¸­ç»§æœåŠ¡
- 21118/21119(TCP) - ä¸ºäº†æ”¯æŒç½‘é¡µå®¢æˆ·ç«¯

ğŸ’¡ å¦‚æœå¯åŠ¨çš„æ—¶å€™ä¸åŠ  `-k _` å‚æ•°ï¼Œåˆ™ä¸ä½¿ç”¨ `key` ä¹Ÿå¯ä»¥è¿æ¥æœåŠ¡å™¨ã€‚
{: .notice}

## ç¯å¢ƒé…ç½®

è®¾ç½®æ—¶åŒºï¼ˆå¯é€‰ä½†æ¨èï¼‰
```bash
# è®¾ç½®æ—¶åŒºä¸ºä¸œå…«åŒºçš„ä¸Šæµ·
sudo timedatectl set-timezone Asia/Shanghai
date +%Z  # åº”è¾“å‡º CST
```

æ›´æ–°ç³»ç»Ÿå¹¶å®‰è£…åŸºç¡€ä¾èµ–
```bash
sudo apt update && sudo apt upgrade -y
sudo apt install curl htop wget unzip -y
```

å®‰è£… Node.js ä¸ npm
```bash
sudo apt install nodejs npm -y
node -v  # æŸ¥çœ‹ Node.js ç‰ˆæœ¬
npm -v   # æŸ¥çœ‹ npm ç‰ˆæœ¬
```

å®‰è£… pm2
```bash
sudo npm install -g pm2
pm2 --version  # æŸ¥çœ‹pm2çš„ç‰ˆæœ¬
```

åˆ›å»º pm2 å¼€æœºå¯åŠ¨è„šæœ¬
```bash
pm2 completion install  # æ ¹æ®æç¤ºä¿¡æ¯å®Œæˆ
```

è®¾ç½® pm2 å¼€æœºå¯åŠ¨
```bash
sudo env PATH=$PATH:/usr/bin /usr/local/lib/node_modules/pm2/bin/pm2 startup systemd -u ${USER} --hp ${HOME}
sudo systemctl enable pm2-${USER}
```

## å®‰è£…å¹¶éƒ¨ç½² RustDesk-Server

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è‡ªåŠ¨è·å– GitHub ä¸Š `rustdesk/rustdesk-server` ä»“åº“çš„æœ€æ–°å‘å¸ƒç‰ˆæœ¬å¹¶ä¸‹è½½

```bash
REPO="rustdesk/rustdesk-server"
latest_tag=$(curl -s https://api.github.com/repos/$REPO/releases/latest | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
echo "Using rustdesk-server version $latest_tag"

wget https://github.com/$REPO/releases/download/$latest_tag/rustdesk-server-linux-amd64.zip
```

è§£å‹å¹¶æ•´ç†æ–‡ä»¶
```bash
unzip rustdesk-server-linux-amd64.zip
mv amd64 ~/rustdesk-server
rm -f rustdesk-server-linux-amd64.zip
```

æ­¤æ—¶ï¼ŒRustDesk çš„ä¸¤ä¸ªæ ¸å¿ƒå¯æ‰§è¡Œæ–‡ä»¶ `hbbs` å’Œ `hbbr` å·²ä½äº `~/rustdesk-server/` ç›®å½•ä¸‹ã€‚

è¿›å…¥ RustDesk ç›®å½•å¹¶å¯åŠ¨ä¸¤ä¸ªæœåŠ¡
```bash
cd ~/rustdesk-server
pm2 start hbbs -- -k _
pm2 start hbbr -- -k _
```

ğŸ’¡ `-k _`ï¼šè¡¨ç¤ºä¸å¯ç”¨å¯†é’¥éªŒè¯ï¼ˆå³å®¢æˆ·ç«¯æ— éœ€å¡«å†™å¯†é’¥å³å¯è¿æ¥ï¼‰ã€‚è‹¥éœ€å¯ç”¨å¯†é’¥è®¤è¯ï¼Œå¯æ›¿æ¢ `_` ä¸ºè‡ªå®šä¹‰å¯†é’¥ï¼Œå¦‚ `-k mysecret123` ã€‚
{: .notice}

ä¿å­˜ PM2 è¿›ç¨‹çŠ¶æ€ï¼ˆç”¨äºå¼€æœºæ¢å¤ï¼‰
```bash
pm2 save
```

æ­¤å‘½ä»¤ä¼šå°†å½“å‰è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ä¿å­˜ï¼Œé…åˆä¹‹å‰é…ç½®çš„ `pm2 startup`ï¼Œç¡®ä¿ç³»ç»Ÿé‡å¯åæœåŠ¡è‡ªåŠ¨æ¢å¤ã€‚

éªŒè¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
```bash
pm2 list
```

åº”çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹è¾“å‡º
```bash
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name     â”‚ namespace   â”‚ version â”‚ mode    â”‚ status   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ hbbs     â”‚ default     â”‚ N/A     â”‚ fork    â”‚ online   â”‚
â”‚ 1  â”‚ hbbr     â”‚ default     â”‚ N/A     â”‚ fork    â”‚ online   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è‹¥çŠ¶æ€ä¸º `online`ï¼Œè¯´æ˜æœåŠ¡å·²æˆåŠŸå¯åŠ¨ã€‚

æ­¤æ—¶æŸ¥çœ‹ rustdesk-server ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€äº›æ•°æ®åº“æ–‡ä»¶å’Œä¸€ä¸ªè¯ä¹¦æ–‡ä»¶
```bash
rustdesk-server
â”œâ”€â”€ db_v2.sqlite3
â”œâ”€â”€ db_v2.sqlite3-shm
â”œâ”€â”€ db_v2.sqlite3-wal
â”œâ”€â”€ hbbr
â”œâ”€â”€ hbbs
â”œâ”€â”€ id_ed25519
â”œâ”€â”€ id_ed25519.pub
â””â”€â”€ rustdesk-utils
```

éœ€è¦æ‹·è´å…¬é’¥æ–‡ä»¶ `id_ed25519.pub` ä¸­çš„å†…å®¹ï¼ˆä¾‹å¦‚`C6bJn7*******************50nCK3y4=`ï¼‰ï¼Œç”¨äºæ¥ä¸‹æ¥çš„æœ¬åœ°é…ç½®ã€‚

## å®¢æˆ·ç«¯é…ç½®

æ‰“å¼€ RustDesk å®¢æˆ·ç«¯ï¼Œç‚¹å‡»å·¦ä¸Šè§’ `ID` æ—è¾¹çš„ä¸‰ç‚¹å›¾æ ‡ï¼Œè¿›å…¥è®¾ç½®ã€‚

åˆ‡æ¢åˆ° `ç½‘ç»œ` é€‰é¡¹å¡ï¼Œç‚¹å‡» `ID/ä¸­ç»§æœåŠ¡å™¨` ï¼š
- åœ¨ `ID æœåŠ¡å™¨` å­—æ®µä¸­å¡«å†™ä½ çš„äº‘æœåŠ¡å™¨å…¬ç½‘ IP åœ°å€æˆ–åŸŸåã€‚
- åœ¨ `key` å­—æ®µä¸­å¡«å†™åˆšæ‰æ‹·è´çš„å…¬é’¥å†…å®¹ï¼ˆä¾‹å¦‚ `C6bJn7*******************50nCK3y4` ï¼‰

ç‚¹å‡» `ç¡®è®¤`ï¼Œå›åˆ°ä¸»é¡µï¼Œç­‰å¾…å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œå³å¯å®Œæˆé…ç½®ã€‚
