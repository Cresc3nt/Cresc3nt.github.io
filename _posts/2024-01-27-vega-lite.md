---
layout: post
title: 带有Vega-Lite的文章
date: 2024-01-27 00:20:00
last_updated: 2024-04-14 04:30:00  # 最后更新时间
description: 这是包含Vega-Lite代码的样子
tags: [格式化, 图表]
categories: [示例文章]
chart:  # 图表配置
  vega_lite: true  # 启用Vega-Lite
---

这是一篇包含一些[Vega-Lite](https://vega.github.io/vega-lite/)代码的示例文章。

````markdown
```vega_lite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "一张散点图，展示了数据库中的每部电影与其平均评分之间的差异。图表按年份排序，以顺序方式呈现所有 2019 年之前的电影。",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "评分差异"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "评分差异"
    }
  }
}
```
````

渲染结果如下：

```vega_lite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "一张散点图，展示了数据库中的每部电影与其平均评分之间的差异。图表按年份排序，以顺序方式呈现所有 2019 年之前的电影。",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "评分差异"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "评分差异"
    }
  }
}
```

该图表同时支持浅色和深色主题。
